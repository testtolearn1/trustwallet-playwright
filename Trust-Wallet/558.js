"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[558],{66558:(e,t,r)=>{r.r(t),r.d(t,{default:()=>me});var n=r(68927),o=r(18851),s=r(42252);const a=(0,o.createContext)({}),i=({children:e})=>{const[t,r]=(0,o.useState)(null);return(0,n.jsx)(a.Provider,{value:{ledgerApp:t,setLedgerApp:r},children:e})};var c=r(51793),l=r(42973),d=r(47569),u=r(53047),p=r(73713),h=r(1381),m=r(37301),x=r(78861),g=r(5379);const f=5,b={[g.M.Ethereum]:{icon:(0,n.jsx)(l.xi,{}),provider:x.P.ethereum},[g.M.Solana]:{icon:(0,n.jsx)(l.v$,{}),provider:x.P.solana}},v={[g.M.Ethereum]:60,[g.M.Solana]:501};var y=r(36493),E=r.n(y),j=r(35829),S=r.n(j),C=r(81228),A=r(72421),w=(e,t,r)=>new Promise(((n,o)=>{var s=e=>{try{i(r.next(e))}catch(e){o(e)}},a=e=>{try{i(r.throw(e))}catch(e){o(e)}},i=e=>e.done?n(e.value):Promise.resolve(e.value).then(s,a);i((r=r.apply(e,t)).next())}));var P=(e,t,r)=>new Promise(((n,o)=>{var s=e=>{try{i(r.next(e))}catch(e){o(e)}},a=e=>{try{i(r.throw(e))}catch(e){o(e)}},i=e=>e.done?n(e.value):Promise.resolve(e.value).then(s,a);i((r=r.apply(e,t)).next())}));function O(){return{getApp:e=>P(this,null,(function*(){yield x.P.requestToOpenApp(e);const[t,r]=yield b[e].provider();return{value:t,transport:r,name:e}})),detectApp:(0,o.useCallback)((()=>P(this,null,(function*(){const e=yield x.P.detect();if(x.P.supported(e)){const{provider:t}=b[e],[r,n]=yield t();return{value:r,transport:n,name:e}}}))),[])}}var T=r(49292),D=r(30136),R=r(47826),k=Object.defineProperty,_=Object.defineProperties,I=Object.getOwnPropertyDescriptors,L=Object.getOwnPropertySymbols,M=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable,G=(e,t,r)=>t in e?k(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,z=(e,t)=>{for(var r in t||(t={}))M.call(t,r)&&G(e,r,t[r]);if(L)for(var r of L(t))N.call(t,r)&&G(e,r,t[r]);return e},W=(e,t)=>_(e,I(t)),Z=(e,t,r)=>new Promise(((n,o)=>{var s=e=>{try{i(r.next(e))}catch(e){o(e)}},a=e=>{try{i(r.throw(e))}catch(e){o(e)}},i=e=>e.done?n(e.value):Promise.resolve(e.value).then(s,a);i((r=r.apply(e,t)).next())}));function V(e,t){const{fetch:r}=function(e){const t=(0,A.S)();return{fetch:(0,o.useCallback)((r=>w(this,null,(function*(){if(d.Z.debug(`Fetching balance of ${r}`),(null==e?void 0:e.name)===g.M.Ethereum){const[{url:e}]=t.ethereum.nodes,n=new(E())(e);return E().utils.fromWei(yield n.eth.getBalance(r),"ether")}if((null==e?void 0:e.name)===g.M.Solana){const[{url:e}]=t.solana.nodes,n=new C.Connection(e),o=new C.PublicKey(r),s=yield n.getBalance(o);return new(S())(s).div(C.LAMPORTS_PER_SOL).toString()}return"0"}))),[null==e?void 0:e.name,t.ethereum.nodes,t.solana.nodes])}}(e),{detectApp:n}=O(),[s,a]=(0,o.useState)(!0),[i,c]=(0,o.useState)(null),l=(0,o.useMemo)((()=>e?v[null==e?void 0:e.name]:null),[e]),u=(0,D.Cf)({assetId:`c${l}`}),p=(0,R.v9)((e=>e.wallet.accounts)),[h,m]=(0,o.useState)([]),[b,y]=(0,o.useState)([]),[j,P]=(0,o.useState)(!1),k=(0,o.useCallback)((e=>y(b.filter((t=>t.address!==e)))),[b]),_=(0,o.useCallback)((e=>y([...b,{address:e.address,ledgerAccountIndex:e.ledgerAccountIndex}])),[b]);return(0,o.useEffect)((()=>{if(Object.keys(b).length+Object.keys(p).length>=T.AX)return P(!0);P(!1)}),[b,j,p]),(0,o.useEffect)((()=>{!function(){Z(this,null,(function*(){if(e&&u)try{a(!0);const e=yield n(),o=[],s=[];for(let r=t;r<t+f;r++){const t=yield x.P.getAddress(e,r);t&&o.push(t)}yield Promise.all(o.map(((e,t)=>Z(this,null,(function*(){const n=yield r(e.address),o={fiat:Number(n)*u.price,crypto:n},a=!!Object.values(p).find((t=>l&&t[l].address===e.address)),i=W(z({},e),{balance:o,alreadyAdded:a,ledgerAccountIndex:t});s.push(i)}))))),s.sort(((e,t)=>t.balance.fiat-e.balance.fiat));const i=s.find((e=>!e.alreadyAdded));i&&!b.length&&y([{address:i.address,ledgerAccountIndex:i.ledgerAccountIndex}]),m(s)}catch(e){c(e),d.Z.error(e)}finally{a(!1)}}))}()}),[l,t,r,e]),{isLoading:s,selectedAccounts:b,accounts:h,reachedMaximumAmountOfWallets:j,removeAccount:k,addAccount:_,error:i}}var X=(e,t,r)=>new Promise(((n,o)=>{var s=e=>{try{i(r.next(e))}catch(e){o(e)}},a=e=>{try{i(r.throw(e))}catch(e){o(e)}},i=e=>e.done?n(e.value):Promise.resolve(e.value).then(s,a);i((r=r.apply(e,t)).next())}));const H=()=>(0,o.useContext)(a);var Y=r(21621),$=r(25120),F=r(77885),q=r(91302),J=r(80544),U=r(90778),B=r(24775);const K=({address:e,balance:t,selected:r,disabled:o,alreadyAdded:s,setSelectedWalletAddress:a,removeSelectedWalletAddress:i})=>{const{colors:c,sizes:d,fontWeights:h,fontSizes:x}=(0,m.Y)(),{formatMessage:g,locale:f}=(0,p.Z)();return(0,n.jsx)(u.HCh,{children:(0,n.jsxs)(u.kCb,{as:"button",type:"button",onClick:()=>{if(r)return i(e);o||a(e)},align:"center",h:`${u.q7h}px`,borderRadius:d[4.5],_hover:{bg:c.inverseOnSurface,cursor:s||o&&!r?"not-allowed":"pointer"},pl:d[4],pr:d[2],textAlign:"left",w:"100%",children:[(0,n.jsx)(u.Aqk,{checked:r,mr:d[4.5],opacity:s?"0.4":"1",cursor:o&&!r?"not-allowed":"pointer",radioType:u.E1D.SQUARE}),(0,n.jsx)(l.xi,{boxSize:"10",mr:d[2],opacity:s?"0.4":"1"}),(0,n.jsxs)(u.kCb,{justifyContent:"space-between",w:"100%",children:[(0,n.jsxs)(u.xuv,{opacity:s?"0.4":"1",children:[(0,n.jsx)(u.xvT,{as:"h3",fontWeight:h[500],fontSize:x[4],lineHeight:d[6],children:(0,u.j5f)({value:e,maxCharsPerSide:7})}),(0,n.jsxs)(u.xvT,{as:"span",fontSize:x[3.5],lineHeight:d[5],children:[(0,u.pZe)({locale:f,amount:+Number(t.crypto).toFixed(5),displaySymbol:"ETH"}),` (~ ${(0,u.xA4)({locale:"en-US",amount:t.fiat,currency:"USD"})})`]})]}),s&&(0,n.jsx)(u.xvT,{color:c.onPrimaryContainer,background:c.primaryContainer,fontWeight:500,px:d[2],borderRadius:29,alignSelf:"center",lineHeight:d[4],fontSize:d[2.75],opacity:"1",children:g({id:"import-ledger-select-account.item.already-added"})})]})]})})};var Q=(e,t,r)=>new Promise(((n,o)=>{var s=e=>{try{i(r.next(e))}catch(e){o(e)}},a=e=>{try{i(r.throw(e))}catch(e){o(e)}},i=e=>e.done?n(e.value):Promise.resolve(e.value).then(s,a);i((r=r.apply(e,t)).next())}));var ee=r(61783);const te=()=>{const{formatMessage:e}=(0,p.Z)(),{sizes:t,colors:r}=(0,m.Y)();return(0,n.jsxs)(u.kCb,{direction:"column",align:"center",w:"100%",mt:t[6],children:[(0,n.jsx)(u.IG5.Offline,{height:t[30],width:t[30]}),(0,n.jsx)(u.xvT,{color:r.onSurfaceVariant,textAlign:"center",fontSize:t[3.5],width:"70%",mt:t[6],mb:t[12],children:e({id:"import-ledger-connection-error.description"})})]})},re=()=>{const{formatMessage:e}=(0,p.Z)(),{sizes:t,colors:r}=(0,m.Y)();return(0,n.jsxs)(u.kCb,{direction:"column",align:"center",color:r.onSurfaceVariant,fontSize:t[3.5],children:[(0,n.jsx)(u.$jN,{mt:t[16],mb:t[8],w:t[16],h:t[16]}),(0,n.jsx)(u.xvT,{children:e({id:"import-ledger-connect.spinner.title"})}),(0,n.jsx)(u.xvT,{children:e({id:"import-ledger-connect.spinner.description"})}),(0,n.jsx)(u.TaI,{size:t[14]})]})};var ne=Object.defineProperty,oe=Object.defineProperties,se=Object.getOwnPropertyDescriptors,ae=Object.getOwnPropertySymbols,ie=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable,le=(e,t,r)=>t in e?ne(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,de=(e,t)=>{for(var r in t||(t={}))ie.call(t,r)&&le(e,r,t[r]);if(ae)for(var r of ae(t))ce.call(t,r)&&le(e,r,t[r]);return e};const ue=(pe=de({},s.Wh),he={[c.GX.CONNECT_LEDGER_DEVICE]:({ledgerConnectionError:e,setCurrentStep:t,setLedgerConnectionError:r})=>{const{formatMessage:s}=(0,p.Z)(),{colors:a,sizes:i}=(0,m.Y)(),{getApp:h}=O(),{setLedgerApp:x}=H(),{setCurrentFlow:f}=(0,ee.A)(),[v,y]=(0,o.useState)(!1),[E,j]=(0,o.useState)(g.M.Ethereum),S=(0,o.useMemo)((()=>[{label:"Ethereum",icon:b.Ethereum.icon,onClick:()=>j("Ethereum")}]),[]),C=e=>{return n=void 0,o=null,s=function*(){e.preventDefault(),r(!1),y(!0);try{const e=yield h(E);x(e),setTimeout((()=>{t(c.GX.IMPORT_LEDGER_ADDRESS)}),500)}catch(e){d.Z.error(e),y(!1),r(!0)}},new Promise(((e,t)=>{var r=e=>{try{i(s.next(e))}catch(e){t(e)}},a=e=>{try{i(s.throw(e))}catch(e){t(e)}},i=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,a);i((s=s.apply(n,o)).next())}));var n,o,s};return(0,n.jsx)(u.uTp.Scroll,{children:(0,n.jsxs)(B.C,{as:"form",onSubmit:C,heading:s({id:"import-ledger-connect-device.heading"}),ledgerSelector:(0,n.jsx)(u.udT,{variant:"standard",title:E,icon:b[E].icon,mt:i[4],children:(0,n.jsx)(u.Ltx,{actions:S,top:i[7],left:"50%",transform:"translateX(-50%)"})}),activeTab:2,children:[e&&(0,n.jsx)(te,{})||v&&(0,n.jsx)(re,{})||(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.M5Y,{w:"100%",h:"185px",bg:a.surface1,borderRadius:i[4.5],children:(0,n.jsx)(l.Wf,{mt:"-"+i[4]})}),(0,n.jsx)(u.xvT,{mt:i[6],color:a.onSurfaceVariant,textAlign:"center",children:s({id:"import-ledger-connect-device.open-app-description"},{strong:()=>(0,n.jsxs)(u.xuv,{as:"span",fontWeight:"500",whiteSpace:"nowrap",children:[(0,n.jsx)(l.Uq,{mb:i[1],mr:i[.5]}),E]})})})]}),(0,n.jsx)(U.N,{buttonCancelProps:{onClick:()=>{f(c.ZY.HOME)}},buttonSubmitProps:{children:s({id:"import-ledger-connect.submit-button"}),onClick:C}})]})})},[c.GX.IMPORT_LEDGER_ADDRESS]:({setCurrentStep:e})=>{const{formatMessage:t}=(0,p.Z)(),{sizes:r,colors:s,fontSizes:a,lineHeights:i,fontWeights:x}=(0,m.Y)(),{ledgerApp:g}=H(),{getLedgerDeviceName:b}=function(){return{getLedgerDeviceName:(0,o.useCallback)((()=>X(this,null,(function*(){const e=(yield navigator.usb.getDevices()).find((e=>"Ledger"===e.manufacturerName));return`${e.manufacturerName} ${e.productName}`}))),[])}}(),{trackAnalyticsEvent:v,isAnalyticsEnabled:y}=(0,h.z)(),{data:{password:E},update:j}=(0,o.useContext)(F.t),[S,C]=(0,o.useState)(!1),[A,w]=(0,o.useState)(""),[P,O]=(0,o.useState)(0),{reachedMaximumAmountOfWallets:D,selectedAccounts:R,accounts:k,removeAccount:_,addAccount:I,isLoading:L}=V(g,P);return(0,o.useEffect)((()=>{Q(void 0,null,(function*(){w(yield b())}))}),[b]),(0,n.jsx)(u.uTp.Scroll,{children:(0,n.jsxs)(B.C,{as:"form",mb:r[8],heading:t({id:"import-ledger-select-account.heading"}),subHeading:t({id:"import-ledger-select-account.subheading"}),activeTab:3,children:[(0,n.jsxs)(u.kCb,{align:"center",w:"100%",bgColor:s.surface2,py:r[3],px:r[4],borderRadius:r[2],gap:r[4],mb:r[4],children:[(0,n.jsx)(l.ZV,{}),(0,n.jsxs)(u.xuv,{color:s.onSurfaceVariant,children:[(0,n.jsx)(u.xvT,{as:"span",display:"block",fontSize:a[3],lineHeight:i[4],children:t({id:"import-ledger-select-account.input-placeholder"})}),(0,n.jsx)(u.xvT,{as:"strong",display:"inline-block",fontSize:a[3.5],lineHeight:i[5],fontWeight:x[500],children:A})]})]}),D&&(0,n.jsxs)(u.bZj,{status:"warning",display:"flex",alignItems:"center",gap:r[2],mb:r[4],children:[(0,n.jsx)(l.aN,{width:"20px",height:"20px"}),(0,n.jsx)("span",{children:t({id:"import-ledger-select-account.reached-max-warning"},{b:()=>(0,n.jsx)("b",{children:T.AX})})})]}),L?(0,n.jsxs)(u.gCW,{color:s.onSurfaceVariant,fontSize:r[3.5],children:[(0,n.jsx)(u.$jN,{mt:r[16],mb:r[7],w:r[16],h:r[16]}),(0,n.jsx)(u.xvT,{children:t({id:"import-ledger-select-account.spinner.description"})}),(0,n.jsx)(u.TaI,{size:r[13]})]}):(0,n.jsx)(u.aVo,{display:"grid",gap:r[2],w:"100%",children:null==k?void 0:k.map((e=>(0,n.jsx)(K,{address:e.address,balance:e.balance,alreadyAdded:e.alreadyAdded,disabled:D,selected:R.some((t=>t.address===e.address))||e.alreadyAdded,setSelectedWalletAddress:()=>I(e),removeSelectedWalletAddress:_},e.address)))}),(0,n.jsxs)(u.kCb,{mb:r[6],mt:r[2],justifyContent:"flex-end",w:"100%",children:[(0,n.jsx)(u.zxk,{onClick:()=>O(P-f),disabled:0===P||L,variant:"ghost",color:s.primary,children:t({id:"import-ledger-select-account.pagination.previous"})}),(0,n.jsx)(u.zxk,{onClick:()=>O(P+f),variant:"ghost",disabled:L,color:s.primary,children:t({id:"import-ledger-select-account.pagination.next"})})]}),(0,n.jsx)(u.izJ,{w:$.nR}),(0,n.jsx)(U.N,{buttonCancelProps:{onClick:()=>{e(c.GX.CONNECT_LEDGER_DEVICE)}},buttonSubmitProps:{onClick:()=>Q(void 0,null,(function*(){if(!g)return e(c.GX.CONNECT_LEDGER_DEVICE);try{C(!0),yield Promise.all(R.map((({address:e,ledgerAccountIndex:t})=>q.Tl.emit(J.Z.IMPORT_LEDGER_ADDRESS,{address:e,ledgerAccountIndex:t,password:E,preventSwitch:!0,appName:g.name})))),v(Y.d.IMPORT_LEDGER_WALLET_COMPLETE,{force:null===y}),j({password:""}),e(c.GX.ACCEPT_ANALYTICS)}catch(e){d.Z.error(e),C(!1)}})),isDisabled:S,disabled:!R.length||S,children:t({id:"import-ledger-select-account.submit"})}})]})})}},oe(pe,se(he)));var pe,he;const me=()=>{const[e,t]=(0,o.useState)(c.GX.CREATE_VERIFY_PASSWORD),[r,s]=(0,o.useState)(!1),a=ue[e];return(0,o.useEffect)((()=>{r&&t(c.GX.CONNECT_LEDGER_DEVICE)}),[r]),(0,n.jsx)(i,{children:(0,n.jsx)(a,de({setCurrentStep:t},e===c.GX.CONNECT_LEDGER_DEVICE&&{setLedgerConnectionError:s,ledgerConnectionError:r}||e===c.GX.IMPORT_LEDGER_ADDRESS&&{setLedgerConnectionError:s}))})}},80544:(e,t,r)=>{r.d(t,{Z:()=>o});var n=r(41513);const o={GENERATE_HD_WALLET:(0,n.Jp)("GenerateHDWallet"),IMPORT_MNEMONIC:(0,n.Jp)("ImportMnemonic"),IMPORT_LEDGER_ADDRESS:(0,n.Jp)("ImportLedgerAddress")}}}]);